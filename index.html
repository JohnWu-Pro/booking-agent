<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bookmarklet</title>
  <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" sizes="48x48">
  <style>
    body {
      font-size: x-large;
    }
    code {
      background: rgb(192, 224, 255);
      font-weight: bold;
    }
    code.block {
      border: 1px dotted gray;
      background: rgb(224, 224, 255);
      cursor: pointer;
    }
    span.msg {
      color: blue;
    }
    span.msg.hidden {
      color: white;
    }
  </style>
</head>

<body>
  <h2>BookingAgent</h2>
  <ul>
    <li><b>Function</b>: Assist in booking Court or Drop-in that's powered by <a href="https://mobileapp.courtreserve.com" target="_blank">CourtReserve</a>.</li>
    <li><b>Key Feature</b>: Schedule to click the <code>Confirm</code> button just in time, after you filling in all required fields.</li>
  </ul>

  <h3>Create a Bookmark</h3>
  <ol>
    <li>Go to <a href="https://johnwu-pro.github.io/booking-agent/index.html">https://johnwu-pro.github.io/booking-agent/index.html</a>.</li>
    <li>Tap the browser menu (three vertical dots, e.g. <code>&nbsp;⋮&nbsp;</code>, at the top-right or bottom-right corner), and select "Add bookmark" or the star icon (e.g. <code>⭐</code>).</li>
    <li>Save it, naming it <code>BookingAgent</code>.</li>
  </ol>

  <h3>Edit the Bookmark</h3>
  <ol>
    <li>Go to <a href="https://johnwu-pro.github.io/booking-agent/index.html">https://johnwu-pro.github.io/booking-agent/index.html</a>.</li>
    <li>Tap the code block below to copy it to the clipboard.<br>
      <code class="block" onclick="copyToClipboard(this)">
javascript:(() => {
  const url = 'https://johnwu-pro.github.io/booking-agent/bootstrap.js';
  document.head.appendChild(document.createElement('script')).src=url+'?'+Date.now();
})();</code><br>
      <span class="msg hidden">The code block above is copied to the clipboard successfully.</span>
    </li>
    <li>Go to your browser bookmark list and find the <code>BookingAgent</code>.</li>
    <li>Tap and hold (or tap the menu next to it) and select Edit.</li>
    <li>Replace the URL with the code in the clipboard (which you just copied from the code block above).</li>
    <li>Save the change.</li>
  </ol>

  <h3>Use the Bookmark - To assist booking the court</h3>
  <ol>
    <li>A few minutes before the reservation is open, go to <a href="https://mobileapp.courtreserve.com" target="_blank">https://mobileapp.courtreserve.com</a></li>
    <li>Log in to the web version of the APP.</li>
    <li>Choose your organization, e.g. <code>HiSports Stouffville</code>.</li>
    <li>Choose to <code>Book a Court</code> and go through the operations as you usually do, and just stop before clicking the <code>Confirm</code> button.</li>
    <li>Type <code>BookingAgent</code> in the address bar and select the <b>suggested the bookmark</b> (to launch the BookingAgent).</li>
    <li>Tap the <code>☰</code> at the bottom-right of the screen (to launch the dialog).</li>
    <li>Follow the tips in the dialog to schedule (and eventually trigger) the booking confirmation.</li>
    <li>Have Fun!</li>
  </ol>

  <script>
    function $E(cssSelector, container) {
      return (container ?? document).querySelector(cssSelector);
    }
    function copyToClipboard(element) {
      $E('span.msg').classList.add('hidden');

      const text = element.textContent;
      navigator.clipboard.writeText(text).then(() => {
        $E('span.msg').classList.remove('hidden');
      }).catch(err => {
        console.error('Could not copy text to clipboard.', err);
      });
    }
  </script>
</body>

</html>
